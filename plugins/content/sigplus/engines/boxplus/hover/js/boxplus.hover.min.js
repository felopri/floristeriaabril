/*
 boxplus lightweight window engine on mouse-over
 @author  Levente Hunyadi
 @version 1.4.2
 @remarks Copyright (C) 2009-2010 Levente Hunyadi
 @remarks Licensed under GNU/GPLv3, see http://www.gnu.org/licenses/gpl-3.0.html
 @see     http://hunyadi.info.hu/projects/boxplus
*/
if(typeof __jQuery__=="undefined")var __jQuery__=jQuery;
(function(b){function r(a,d){var e=parseInt(a.css(d));return isNaN(e)?a[d]():e}function s(a,d){a+=c.outerWidth(true)-parseInt(c.css("width"));d+=c.outerHeight(true)-parseInt(c.css("height"));var e=b("img:first",f),h=e.offset(),k=h.left-g.scrollLeft();h=h.top-g.scrollTop();var t=e.outerWidth(),u=e.outerHeight(),m=[k+t+a-g.width(),h+u+d-g.height(),a-k];e=-1;var v=Infinity,i;for(i in m)if(m[i]<v){e=i;v=m[i]}m=(g.width()-a)/2;i=(g.height()-d)/2;k=[k+t+20,m,k-a-20];h=[i,h+u+20,i];return{left:g.scrollLeft()+
k[e],top:g.scrollTop()+h[e]}}function w(){clearTimeout(l);l=setTimeout(x,100)}function z(a){f=b(a.currentTarget);l=setTimeout(x,100);f.bind("mousemove",w)}function y(){f.unbind("mousemove",w);if(l){clearTimeout(l);l=null}}function x(){y();c.css(s(n,o));c.css({width:n,height:o});b(q=new Image).load(A).attr("src",f.attr("href"));c.removeClass("hide")}function B(){y();c.stop();c.addClass("hide");p.addClass("hide");j.addClass("hide")}function A(){var a=q.width,d=q.height;p.css({width:a,height:d});p.css("background-image",
'url("'+f.attr("href")+'")');q=null;a=b.extend({width:a,height:d},s(a,d));c.css({width:n,height:o,left:a.left+(a.width-n)/2,top:a.top+(a.height-o)/2});c.animate(a,"fast","swing",C)}function C(){p.removeClass("hide");var a=b("img:first",f).attr("alt"),d=f.attr("title");a&&a!=d?b(".title",j).html(a):b(".title",j).empty();b(".caption",j).html(d);if(a||d){a=c.dimensions();a.height+=j.outerHeight(true);c.animate(a,"slow","swing",D)}}function D(){j.removeClass("hide")}b.fn.safeWidth=function(){return r(this,
"width")};b.fn.safeHeight=function(){return r(this,"height")};var c,n,o,p,j,g=b(window),q,f,l;b(function(){b("body").append('<div id="boxplus-dialog" class="hide"><div id="boxplus-viewer" class="hide"></div><div id="boxplus-caption" class="hide"><p class="title"></p><p class="caption"></p></div></div>');c=b("#boxplus-dialog");n=c.safeWidth();o=c.safeHeight();p=b("#boxplus-viewer");j=b("#boxplus-caption")});b.fn.dimensions=function(){return{width:parseInt(this.css("width")),height:parseInt(this.css("height"))}};
b.fn.boxplusHover=function(){b(this).hover(z,B)};b.fn.boxplusHoverGallery=function(){b("li",this).each(function(){var a=b("a:has(img)",this).eq(0);if(a){a.boxplusHover();a.click(function(){return false})}})}})(__jQuery__);
