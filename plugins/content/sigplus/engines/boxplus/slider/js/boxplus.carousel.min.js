/*
 boxplus carousel engine
 @author  Levente Hunyadi
 @version 1.4.2
 @remarks Copyright (C) 2009-2010 Levente Hunyadi
 @remarks Licensed under GNU/GPLv3, see http://www.gnu.org/licenses/gpl-3.0.html
 @see     http://hunyadi.info.hu/projects/boxplus
*/
if("undefined"==typeof __jQuery__)var __jQuery__=jQuery;
(function(c){function s(a,b){return a+b}function q(a,b,h){var l=0;a.each(function(a,d){l=h(l,c(d)[b](!0))});return l}function y(a){function b(a){return("0"+a.toString(16)).slice(-2)}return"#"+b(Math.floor(255*a[3]))+b(a[0])+b(a[1])+b(a[2])}c.fn.maxOuterWidth=function(){return q(this,"outerWidth",Math.max)};c.fn.maxOuterHeight=function(){return q(this,"outerHeight",Math.max)};c.fn.totalOuterWidth=function(){return q(this,"outerWidth",s)};c.fn.totalOuterHeight=function(){return q(this,"outerHeight",
s)};c.fn.backColor=function(){function a(a,b){return c.map(a,function(a){return parseInt(a,b)})}var b=this.css("background-color"),h=[0,0,0],l=1;"transparent"==b&&(l=0);var e=b.match(/^#[\da-f]{6}$/i);if(e)var d=e[0],h=a([d.substr(1,2),d.substr(3,2),d.substr(5,2)],16);if(e=b.match(/^#([\da-f]{3})$/i))d=e[0],h=d.substr(1,1),e=d.substr(2,1),d=d.substr(3,1),h=a([h+h,e+e,d+d],16);(e=b.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))&&(h=a(e.slice(1),10));if(e=b.match(/^rgba\((\d+),\s*(\d+),\s*(\d+)\,\s*(\d+(?:\.\d+)?)\)$/))h=
a(e.slice(1,-1),10),l=parseFloat(e[e.length-1]);h.push(l);return h};c.fn.effectiveBackColor=function(){var a=this;do var b=a.backColor(),a=a.parent();while(0==b[3]);return b};c.fn.boxplusCarousel=function(a){a=c.extend({rtl:!1,orientation:"horizontal",positioning:"side",edges:"sharp",navigation:"top",showButtons:!0,showLinks:!0,showOverlayButtons:!0,contextmenu:!0,duration:800,delay:0,opacity:1},a);var b="vertical"==a.orientation,h=a.windowSize?a.windowSize:b?400:"100%";this.filter("ul, ol").each(function(){function l(){0<
m.queue().length||d(1)}function e(){var a=0,c=0;if(w){var e=g.slice(0,r),d=g.eq(r);b?a=z/2-e.totalOuterHeight()-d.totalOuterHeight()/2:c=s/2-e.totalOuterWidth()-d.totalOuterWidth()/2}a={top:a};a[t]=c;return a}function d(a){var d=g[0<a?"first":"last"](),h=0,h=w?b?g.eq(r).totalOuterHeight()/2+g.eq(r+a).totalOuterHeight()/2:g.eq(r).totalOuterWidth()/2+g.eq(r+a).totalOuterWidth()/2:b?d.totalOuterHeight():d.totalOuterWidth(),f=e();b?f.top-=a*h:f[t]-=a*h;m.animate(f,q,"swing",function(){d.detach()[(0<a?
"append":"prepend")+"To"](m);g=c("li:visible",m);g.css("top",0).css(t,0);m.css(e())})}var q=a.duration,w="center"==a.positioning,t=n?"right":"left",m=c(this).wrap("<div />"),f=m.parent().addClass("boxplus-carousel").addClass("boxplus-disabled");f.wrapInner('<div class="boxplus-viewport" />');var g=c("li:visible",m),x=g.find("img:first").attr("src",function(a,b){var d=c(this).attr("longdesc");return/\.(gif|jpe?g|png)$/i.test(d)?d:b}),r=g.size()/2,k=g.maxOuterWidth(),p=g.maxOuterHeight(),n=a.rtl;m.css({width:b?
k:g.totalOuterWidth(),height:b?g.totalOuterHeight():p,left:n?"auto":0,right:n?0:"auto"});k=b?k:h;p=b?h:p;p=c(".boxplus-viewport",f).css({width:k,height:p});f.css({width:k});var s=p.width(),z=p.height();if(1<g.size()&&f.width()>=s&&f.height()>=z){var n=function(a){return'<a class="boxplus-'+a+'" href="javascript:void(0)" />'},k=function(a){return'<div class="boxplus-'+a+'" />'},A=a.showButtons,B=a.showLinks,n='<div class="boxplus-paging">'+(A?k("prev"):"")+(B?n("prev")+" ":"")+(B?" "+n("next"):"")+
(A?k("next"):"")+"</div>";switch(a.navigation){case "both":f.prepend(n).append(n);break;case "top":f.prepend(n);break;default:f.append(n)}a.showOverlayButtons&&p.append(c(k("prev")+k("next")).addClass("boxplus-large "+(b?"boxplus-vertical":"boxplus-horizontal")));if("blurred"==a.edges){k=function(a){return'<div class="boxplus-edge boxplus-'+a+'" />'};p.append(c((w?k("start"):"")+k("end")).addClass(b?"boxplus-vertical":"boxplus-horizontal"));var u=f.effectiveBackColor(),C=[u[0],u[1],u[2],0];c(".boxplus-edge",
f).each(function(){var a=c(this);a.css("filter",function(a,b){if(b)return b.replace("#ff000000",y(u)).replace("#00000000",y(C))});a.css("background-image",function(a,b){if(b)return b.replace(/#000|#000000|rgb\(0,\s*0,\s*0\)|black/,"rgba("+u.join(",")+")").replace(/rgba\(0,\s*0,\s*0,\s*1\)|transparent/,"rgba("+C.join(",")+")")})})}m.css(e())}a.contextmenu||c(document).bind("contextmenu",function(a){return!x.filter(a.target).size()});c(".boxplus-prev",f).click(function(){if(!(0<m.queue().length)){var a=
g.last();b?a.css("top",-g.totalOuterHeight()):a.css(t,-g.totalOuterWidth());d(-1)}});c(".boxplus-next",f).click(l);f.removeClass("boxplus-disabled");m.css({visibility:"visible"});1>a.opacity&&(x.css("opacity",a.opacity),x.hover(function(){c(this).stop().animate({opacity:1},"slow")},function(){c(this).stop().animate({opacity:a.opacity},"slow")}));var v=a.delay;if(0<v){var v=Math.max(v,q),D=window.setInterval(l,v);f.mouseover(function(){window.clearInterval(D)}).mouseout(function(){D=window.setInterval(l,
v)})}});return this}})(__jQuery__);
