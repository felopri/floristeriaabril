/*
 boxplus image slider engine
 @author  Levente Hunyadi
 @version 1.4.2
 @remarks Copyright (C) 2009-2010 Levente Hunyadi
 @remarks Licensed under GNU/GPLv3, see http://www.gnu.org/licenses/gpl-3.0.html
 @see     http://hunyadi.info.hu/projects/boxplus
*/
if(typeof __jQuery__=="undefined")var __jQuery__=jQuery;
(function(b){var q="boxplus-disabled",C="boxplus-hidden",D="boxplus-loading";b.fn.maxOuterWidth=function(){var a=0;this.each(function(q,i){var g=parseInt(b(i).attr("width"));a=Math.max(a,b(i).outerWidth(!0),g?g:0)});return a};b.fn.maxOuterHeight=function(){var a=0;this.each(function(q,i){var g=parseInt(b(i).attr("height"));a=Math.max(a,b(i).outerHeight(!0),g?g:0)});return a};b.fn.boxplusSlider=function(a){a=b.extend({rtl:!1,rowCount:1,columnCount:2,orientation:"horizontal",navigation:"top",step:"page",
showButtons:!0,showLinks:!0,showPageCounter:!0,showOverlayButtons:!0,contextmenu:!0,duration:800,delay:0,opacity:1},a);this.filter("ul, ol").each(function(){function E(b,a,c){for(r=0;r<b;r++)for(s=0;s<a;s++)d.eq(c?r*a+s:s*b+r).css({top:r*m}).css(t?"right":"left",s*k)}function i(b){return'<a class="boxplus-'+b+'" href="javascript:void(0)" />'}function g(b){return'<div class="boxplus-'+b+'" />'}function F(a){return a.filter(function(){return/\.(gif|jpe?g|png)$/i.test(b("img:first",this).attr("longdesc"))})}
function G(a){F(a).each(function(){var a=b("img:first",this);a.attr("data-thumb",a.attr("src")).attr("src",a.attr("longdesc")).removeAttr("longdesc")});a.removeClass(D).children().removeClass(C);H()}function H(){d.slice(c,c+h).mouseenter().mouseleave()}function I(){u("cycle")}function u(a){switch(a){case "first":c=0;break;case "prev":c=c>=o?c-o:0;break;case "next":c=c<v?c+o:v;break;case "last":c=v;break;case "cycle":c=c>=v?0:c+o;break;default:c=Math.floor(a/o)*o}var e=Math.max(0,c-h),f=Math.min(j,
c+2*h);d.slice(0,e).detach();d.slice(f).detach();var g={};y?g.top=-(c/p*m):g[t?"right":"left"]=-(c/w*k);switch(a){case "first":case "last":n.css(b.extend(g,{opacity:0}));A();n.prepend(d.slice(0,e)).append(d.slice(f));n.animate({opacity:1},B,"linear");break;default:A(),n.animate(g,B,"swing",function(){n.prepend(d.slice(0,e)).append(d.slice(f))})}}function A(){L.add(M).toggleClass(q,c<=0);N.add(O).toggleClass(q,c>=v);b(".boxplus-current",e).text(c/h+1);d.slice(Math.max(0,c-h),Math.min(j,c+2*h)).trigger("boxplus-load");
H()}var w=a.rowCount,p=a.columnCount,h=w*p,B=a.duration,z=a.delay,c=0;b("img",this).each(function(){b(this).css({width:b(this).attr("width"),height:b(this).attr("height")})});var d=b("li:visible",this),x=d.find("img:first"),k=x.maxOuterWidth(),m=x.maxOuterHeight(),n=b(this).wrap("<div />"),e=n.parent().addClass("boxplus-slider").addClass(q);e.wrapInner('<div class="boxplus-viewport" />');k=d.maxOuterWidth();m=d.maxOuterHeight();d.css({width:k,height:m});k=d.maxOuterWidth();m=d.maxOuterHeight();var t=
a.rtl,j=d.length,f,l,r,s,y=a.orientation=="vertical";y?(l=p,f=Math.ceil(j/p),E(f,l,!0)):(l=Math.ceil(j/w),f=w,E(f,l));switch(a.step){case "single":var o=y?p:w,v=j-h;break;default:o=h,v=j%h?j-j%h:j-h}n.css({width:l*k,height:f*m,left:t?"auto":0,right:t?0:"auto"});b(".boxplus-viewport",e).css({width:p*k,height:w*m});e.css("width",p*k);f=a.showButtons;l=a.showLinks;var J=a.showPageCounter;if(f||l||J)switch(f='<div class="boxplus-paging">'+(f?g("first")+g("prev"):"")+(l?i("first")+"&nbsp;"+i("prev")+" ":
"")+(J?'<span class="boxplus-current">1</span> / '+('<span class="boxplus-total">'+Math.ceil(j/h)+"</span>"):"")+(l?" "+i("next")+"&nbsp;"+i("last"):"")+(f?g("next")+g("last"):"")+"</div>",a.navigation){case "both":e.prepend(f).append(f);break;case "top":e.prepend(f);break;default:e.append(f)}a.showOverlayButtons&&b(".boxplus-viewport",e).append(b(g("prev")+g("next")).addClass((y?k:m)<120?"boxplus-small":"boxplus-large").addClass(y?"boxplus-vertical":"boxplus-horizontal"));a.contextmenu||b(document).bind("contextmenu",
function(a){return!x.filter(a.target).size()});var M=b(".boxplus-first",e).click(function(){u("first")}),L=b(".boxplus-prev",e).click(function(){u("prev")}),N=b(".boxplus-next",e).click(function(){u("next")}),O=b(".boxplus-last",e).click(function(){u("last")});d.addClass(D).children().addClass(C);G(d.not(F(d).one("boxplus-load",function(a){var c=b(a.target);a=b("img:first",c);b(new Image).load(function(){G(c)}).attr("src",a.attr("longdesc"))}).get()));A();e.removeClass(q);n.css({top:0,left:t?"auto":
0,right:t?0:"auto",visibility:"visible"});x.each(function(a){var c=b(this).parent("a");c.size()&&c[0].href==window.location.href&&u(a)});a.opacity<1&&(x.css("opacity",a.opacity),x.hover(function(){b(this).stop().animate({opacity:1},"slow")},function(){b(this).stop().animate({opacity:a.opacity},"slow")}));if(z>0){z=Math.max(z,B);var K=window.setInterval(I,z);e.mouseover(function(){window.clearInterval(K)}).mouseout(function(){K=window.setInterval(I,z)})}});return this}})(__jQuery__);
