/*
 boxplus image transition engine
 @author  Levente Hunyadi
 @version 1.4.2
 @remarks Copyright (C) 2009-2010 Levente Hunyadi
 @remarks Licensed under GNU/GPLv3, see http://www.gnu.org/licenses/gpl-3.0.html
 @see     http://hunyadi.info.hu/projects/boxplus
*/
if(typeof __jQuery__=="undefined")var __jQuery__=jQuery;
(function(b){function t(a,b){var e=parseInt(a.attr(b)),h=a.css(b);h=/[0-9]+px/.test(h)?parseInt(h):0;return Math.max(a[b](),e?e:0,h?h:0)}var i="boxplus-disabled",u=Math.max,z=Math.floor,v=Math.ceil;b.fn.maxWidth=function(){var a=0;this.each(function(i,e){a=u(a,b(e).safeWidth())});return a};b.fn.maxHeight=function(){var a=0;this.each(function(i,e){a=u(a,b(e).safeHeight())});return a};b.fn.safeWidth=function(){return t(this,"width")};b.fn.safeHeight=function(){return t(this,"height")};b.fn.boxplusTransition=
function(a){a=b.extend({navigation:"horizontal",loop:!0,contextmenu:!0,orientation:"vertical",slices:15,effect:"fade",easing:"swing",duration:500,delay:4E3},a);this.filter("ul, ol").each(function(){function t(){return w("prev")}function e(){return w("next")}function h(b,a,c){var d=j.eq(f);b.css({backgroundImage:'url("'+d.attr("src")+'")',backgroundPosition:(o-d.safeWidth())/2-a+"px "+((p-d.safeHeight())/2-c)+"px"})}function x(b){var a=b.attr("longdesc");a&&b.attr("src",a).attr("longdesc","")}function w(e){function g(){k.css("opacity",
0).show();return{opacity:1}}function i(){k.css(d?"width":"height",0);return d?{width:o}:{height:p}}function m(){k.css(d?"height":"width",0);return d?{height:v(l)}:{width:v(l)}}var k=b(".boxplus-transition-bars",c);y&&(h(c,0,0),k.clearQueue().stop().css("visibility","hidden"));y=!0;switch(e){case "first":f=0;break;case "prev":f=(f-1)%q;break;case "next":f=(f+1)%q;break;case "last":f=q-1;break;default:return}A();x(j.eq(f));x(j.eq((f-1)%q));x(j.eq((f+1)%q));k.css({opacity:1}).each(function(a){var c=
b(this);a=v(a*l+l)-z(a*l);c.css({height:d?a:p,width:d?o:a});a=c.position();h(c,a.left,a.top)});var r;switch(a.effect){case "fade":r=g();break;case "bars":r=i();break;case "bars+fade":r=b.extend(i(),g());break;case "shutter":r=m();break;case "shutter+fade":r=b.extend(m(),g())}k.css("visibility","visible");var n=function(a){return a};switch(e){case "first":case "prev":n=function(a){return s-1-a}}k.each(function(d){d=n(d);var e={duration:500,easing:a.easing};d==s-1&&b.extend(e,{complete:function(){y=
!1;h(c,0,0);k.css("visibility","hidden")}});b(this).delay(d*B/s).animate(r,e)});return!1}function A(){a.loop||(b(".boxplus-prev",c).toggleClass(i,f<=0),b(".boxplus-next",c).toggleClass(i,f>=q-1))}var m=a.navigation=="vertical",d=a.orientation=="horizontal",s=a.slices,B=a.duration,n=a.delay,f=0,y=!1,g=b(this).wrap("<div />").before("<div />").addClass("boxplus-hidden"),D=g.parent().addClass("boxplus-wrapper"),j=b("li",g).css({position:"absolute",left:0,top:0}).find("img:first");j.parent("a").click(function(a){if(!a.isDefaultPrevented())location.href=
this.href});var c=g.prev().addClass("boxplus-transition").addClass(i).click(function(){j.eq(f).parent("a").click()}),q=j.length,o=j.maxWidth(),p=j.maxHeight();D.add(c).css({width:o,height:p});switch(a.navigation){case "horizontal":case "vertical":g="boxplus-"+a.navigation,c.addClass(g),c.prepend(b('<div class="boxplus-prev" /><div class="boxplus-next" />').addClass(g).addClass((m?o:p)<120?"boxplus-small":"boxplus-large")),b(".boxplus-prev",c).click(t),b(".boxplus-next",c).click(e)}a.contextmenu||
b(document).bind("contextmenu",function(a){return!c.children().add(c).filter(a.target).size()});var l=(d?p:o)/s;for(m=0;m<s;m++)g=z(m*l),b('<div class="boxplus-transition-bars" />').css({left:d?0:g,top:d?g:0,height:d?l:p,width:d?o:l,visibility:"hidden"}).appendTo(c);A();c.removeClass(i);w("first");if(n>0){n=u(n,B+500);var C=window.setInterval(e,n);c.mouseover(function(){window.clearInterval(C)}).mouseout(function(){C=window.setInterval(e,n)})}});return this}})(__jQuery__);
